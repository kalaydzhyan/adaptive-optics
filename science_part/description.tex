\documentclass[a4paper]{article}
%\usepackage{latexsym}
%\usepackage[T2A]{fontenc}
\usepackage[russian]{babel}
\usepackage{amssymb}
\usepackage{hhline}
\textwidth=16cm
\textheight=24cm
\begin{document}
%\include mathhyp.tex
\parskip=3mm \oddsidemargin=0cm \voffset=-2cm \sloppy \binoppenalty=10000 \relpenalty=1000
{\bf Цель работы}: предложить алгоритм
вычисления управляющих напряжений, подаваемых на заданное биморфное зеркало, на основе
данных о форме фронта падающей волны. На основе предложенного алгоритма написать
программу и проанализировать возможности зеркала.

{\bf Введение}: Одним из путей улучшения характеристик современых оптических систем и
расширения их возможностей является применение зеркал с управляемой отражающей
поверхностью. Как правило, адаптивные зеркала используются для компенсации искажений
волнового фронта излучения. В ряде задач, например, при динамической фокусировке
лазерного пучка, существенное улучшение параметров оптической системы достигается за счет
компенсации в первую очередь крупномасштабных искажений волонового фронта -
дефокусировки, астигматизма, сферической аберрации. В этом случае бывает удобно
использовать биморфные адаптивные зеркала \cite{uproptsist}, в которых отражающая
поверхность управляется за счет деформаций полупассивного биморфа, образованного
пьезокерамической и зеркальной пластинами. Деформация такого зеркала происходит за счет
поперечного пьезоэффекта, возникающего под действием приложенного к пьезоэлектрической
пластине напряжения. Отклик зеркала является существенно нелокальным. Как правило, при
возбуждении одного из приводов деформируется вся пластина. Для описания такого рода
деформаций удобно разлагать их по какой-либо системе функций, например, по полиномам
Цернике \cite{BornVolf}, широко используемым для описания аберраций в оптических
системах. Искажения волнового фронта также удобно описывать с помощью этих полиномов, что
существенно используется в данной работе.
%\includegraphics[scale=0.5]{im.jpg}

{\bf Характеристики заданного зеркала.} Используется деформируемое биморфное зеркало DM2-30-17, основные технические параметры которого представлены в таблице:
\medskip\\
\begin{tabular}{l l}
Апертура зеркала, мм&40\\
Оптически используемый диаметр, мм&30\\
Толщина зеркала, мм&3.5\\
Число пьезо-дисков, мм&2\\
Диаметр пьезо-дисков, мм&30\\
Толщина пьезо-дисков, мм&0.35\\
Материал подложки&стекло LK-105\\
Число управляющих электродов&17\\
Диапазон управляющих напряжений,В&$\pm300$\\
Габариты держателя (включая разъемы), мм& \O60x42\\
\end{tabular}
\bigskip\\
{\bf Коэффициенты разложния функций отклика DM2-30-17 по полиномам Фурье:}\\
{\tiny\begin{tabular}{|c|c|c|c|c|c|c|c|c|c|c|c|c|c|c|}
\hline% after \\: \hline or \cline{col1-col2} \cline{col3-col4} ...
Channel&Voltage,&\multicolumn{13}{|c|}{Zernike term value, $\mu m$}\\
\hhline{|~|~|-------------|}
\#&V&Z4&Z5&Z6&Z7&Z8&Z9&Z10&Z11&Z12&Z13&Z14&Z15&Z16\\
\hline
1&100&0.716&0.008&-0.007&-0.023&-0.001&0.022&-0.008&0.006&-0.011&-0.003&0.018&-0.003&-0.004\\
2&200&0.212&0.151&0.011&-0.002&0.158&0.009&-0.002&0.028&-0.059&-0.005&0.007&-0.021&-0.011\\
3&200&0.204&-0.018&-0.159&0.132&0.115&0.013&0.011&-0.008&-0.002&0.056&-0.021&-0.012&-0.011\\
4&200&0.190&-0.169&-0.040&0.193&0.013&0.018&-0.019&-0.002&0.064&0.011&-0.030&0.005&-0.013\\
5&200&0.199&-0.025&0.142&0.147&-0.112&0.009&0.008&0.022&0.020&-0.050&-0.018&0.023&-0.011\\
6&200&0.216&0.141&0.050&0.036&-0.190&-0.001&0.012&-0.001&-0.040&-0.016&-0.001&0.040&-0.010\\
7&200&0.210&0.033&-0.126&-0.119&-0.154&-0.001&-0.022&0.012&-0.009&0.065&0.022&0.036&-0.011\\
8&200&0.197&-0.123&-0.034&-0.200&-0.037&0.003&0.026&0.022&0.066&0.018&0.046&0.003&-0.016\\
9&200&0.216&-0.016&0.127&-0.163&0.108&-0.007&0.001&-0.010&0.010&-0.056&0.029&-0.027&-0.014\\
10&200&0.065&0.235&-0.172&0.018&0.042&0.020&0.056&0.050&-0.053&0.043&0.011&0.026&0.002\\
11&200&0.062&-0.182&-0.219&0.062&-0.008&0.024&-0.023&-0.077&0.024&0.054&0.021&0.026&0.005\\
12&200&0.071&-0.199&0.146&0.056&-0.026&0.027&-0.044&0.078&0.049&-0.025&0.025&-0.002&-0.004\\
13&200&0.067&0.175&0.205&0.022&-0.045&0.023&0.092&-0.040&-0.046&-0.055&0.011&-0.029&0.001\\
14&200&0.058&0.219&-0.171&-0.011&-0.049&0.018&-0.078&-0.048&-0.057&0.036&-0.009&-0.023&0.004\\
15&200&0.061&-0.158&-0.214&-0.042&-0.053&0.023&0.028&0.089&0.041&0.047&-0.021&-0.008&-0.005\\
16&200&0.054&-0.204&0.173&-0.040&-0.005&0.023&0.051&-0.085&0.032&-0.033&-0.023&0.016&0.002\\
17&200&0.056&0.177&0.199&-0.021&0.053&0.020&-0.100&0.017&-0.054&-0.035&-0.010&0.027&0.004\\
\hline
\end{tabular}
}
графическое представление функций отклика см. в Приложении.\par
{\bf Основной алгоритм}: Предложенный алгоритм предполагает использование зеркала в системах фазового сопряжения
\cite[Глава~1.\S4]{shmalgauzen}. Будем полагать, что зеркало имеет R каналов управления.
Тогда вносимое зеркалом искажение имеет вид
$$D=\sum\limits_{j=1}^R a^j S_j,$$
 где $a^j$ - управляющие напряжения, $S_j=S_j(r,\theta)$ - соответствующие функции
 отклика. В свою очередь,
$$S_j=\sum\limits_{i=1}^\infty b^i_j Z_i,$$ где $b^i_j$ - табличные значения коэффициентов
разложения функций отклика по полиномам Цернике (не указанные в таблице коэффициенты
считаются равными нулю) $Z_i=Z_i(r,\theta)$ - полиномы Цернике, определяемые следующим
образом:
$$Z_i(r,\theta)=\left\{ \begin{array}{lll}
\sqrt{n+1}R_n^m(r)\sqrt{2}\cos m\theta, & (i\mbox{ четно }& m\neq0)\\
\sqrt{n+1}R_n^m(r)\sqrt{2}\sin m\theta, & (i\mbox{ нечетно }& m\neq0)\\
\sqrt{n+1}R_n^0(r), & m=0\\
\end{array}\right.$$
$$R_n^m(r)=\sum\limits^{(n-m)/2}_{s=0}\frac{(-1)^s(n-s)!r^{n-2s}}{s![(n+m)/2-s]![(n-m)/2-s]!},\, m<n, n-|m|\mbox{ - четное}$$
Условие ортогональности в круге выглядит следующим образом:
$$<Z_i Z_j>\,\,\equiv\frac{1}{\pi}\int\limits_{(0\leq r \leq1)}Z_i(\overrightarrow{r}) Z_j(\overrightarrow{r}) \,d^2\overrightarrow{r}=\delta_{ij}$$
и проверяется непосредственной подстановкой. \\ Требуется найти $A=(a^j)$. Введем
функционал
$$\mathcal{F}\equiv\sum\limits_{(r,\theta)}(D + F)^2,$$ где $F=F(r,\theta)$ - фронт
падающей волны и суммирование производится по конечному набору точек $(r,\theta)$
единичного круга. Задача сводится к нахождению $A$, для которого $\mathcal{F}=min$, т.е.
$$\mathcal{F}=\sum\limits_{(r,\theta)}(\sum\limits_{j=1}^R a^j S_j + F)^2=min$$
Необходимое условие на экстремум: $\frac{\partial \mathcal{F}}{\partial a^k}=0,\,
k=\overline{1,R}$. Учитывая, что $\frac{\partial}{\partial a^k}\sum\limits_{j=1}^R a^j
S_j=\sum\limits_{j=1}^R \delta^j_k S_j=S_k$,
имеем:$$\sum\limits_{(r,\theta)}[2(\sum\limits_{j=1}^R a^j S_j + F)S_k]=0,$$
$$-\sum\limits_{(r,\theta)}S_k \sum\limits_{j=1}^R a^j S_j = \sum\limits_{(r,\theta)}F
S_k,$$ меняя порядок суммирования имеем окончательно $$-\sum\limits_{j=1}^R a^j
\sum\limits_{(r,\theta)} S_k S_j = \sum\limits_{(r,\theta)}F S_k$$

Проверка на достаточность: $\frac{\partial^2\mathcal{F}}{\partial
{a^k}^2}=\sum\limits_{(r,\theta)}2S^2_k\geqslant0$. Равенство нулю достигается только
если все $S_k=0$, что в нашем случае не имеет смысла. Следовательно
$\frac{\partial^2\mathcal{F}}{\partial {a^k}^2}>0$ и найденные из необходимого условия
значения отвечают локальному минимуму.\\
Пусть теперь $$b_{kj}\equiv\sum\limits_{(r,\theta)}S_k S_j\mbox{ и }c_k\equiv -
\sum\limits_{(r,\theta)}F S_k,$$ тогда
\begin{equation}\label{main}b_{kj}a^j=c_k\end{equation} или в матричном виде: $B*A=C$. Таким
образом, получена связь (\ref{main}) между управляющими напряженими и формой падающего
фронта.
    Можно было бы выразить искомый набор значений как $A=B^{-1}*C$, однако на
практике это мало эффективно, так как, при большом числе каналов управления, требуется
значительное время на обращение матрицы $B$. Вернемся к выражению $B*A=C$ и будем
рассматривать его как матричную запись системы линейных алгебраических уравнений
относительно переменных $a^{j}$. Представим матрицу $B$ в виде произведения
нижнетреугольной матрицы L с единичной главной диагональю и верхнетреугольной матрицы U:
$$B = L*U$$
Тем самым мы сведем задачу к решению двух систем с треугольными матрицами.

{\bf Алгоритм построения $LU$-разложения}.
    Пусть требуется найти нижнюю треугольную матрицу $L=(l_{ij})$ и верхнюю треугольную
матрицу $U=(u_{ij})$ с единицами на главной диагонали такую, что $B = L*U$, т.е.
\begin{equation}
\label{12} \sum\limits^R_{j=1}l_{ij}u_{jk}=b_{ik},\mbox{   }i, k=1, \ldots, R.
\end{equation}
Поскольку $l_{ij}=0$ при $i<j,\mbox{    }u_{jk}=0$ при $j<k,\mbox{  }u_{jj}=1$, то
(\ref{12}) есть система из $R^2$ уравнений относительно $R(R+1)/2$ неизвестных $l_{ij},
i\geq j$ и $R(R-1)/2$ неизвестных $u_{jk}, j<k$, всего $R(R+1)/2+R(R-1)/2 = R^2$
неизвестных. Получим формулы для решения системы (\ref{12}), которые и составляют
алгоритм нахождения $LU$-разложения.\\
    В силу $l_{ij}=0$ при $i<j,\mbox{ }u_{jk}=0$ при $j<k$ сумма (\ref{12}) имеет вид
$$\sum^{\min\{i,k\}}_{j=1}l_{ij}u_{jk}=b_{ik},\mbox{  } i,k=1,\ldots,R,$$
или $$\left[ \begin{array}{lll}
\sum\limits^k_{j=1}l_{ij}u_{jk}=b_{ik},&k\leq i,&i,k=1,\ldots,R,\\
\sum\limits^i_{j=1}l_{ij}u_{jk}=b_{ik},&k>i,&i,k=1,\ldots,R.\\
\end{array}\right.$$
Выделим в первой из этих сумм отдельно случай $k=1$, а во второй - случай $i=1$ и учтем,
что $u_{kk}=1$ для всех $k=1,\ldots,R$,
$$\left[\begin{array}{l}\left[\begin{array}{lll}
l_{i1}=b_{il},&i=1,\ldots,R,&\\
\sum\limits^{k-1}_{j=1}l_{ij}u_{jk} + l_{ik}=b_{ik},&1<k\leq i,&i,k=2,\ldots,R.\\
\end{array}\right.\\
\left[\begin{array}{lll}
l_{11}u_{1k}=b_{1k},&i=2,\ldots,R,&\\
\sum\limits^{i-1}_{j=1}l_{ij}u_{jk} + l_{ii}u_{ik}=b_{ik},&k>i>1,&i,k=2,\ldots,R.\\
\end{array}\right.\\
\end{array}\right.
$$

Перегруппируем эти формулы:

\begin{equation}
\label{13}
\left[\begin{array}{l}\left[\begin{array}{lll}
l_{i1}=b_{il},&i=1,\ldots,R,&\\
u_{1k}=b_{1k}/l_{11}&k=2,\ldots,R.&\\
\end{array}\right.\\
\left[\begin{array}{lll} l_{ik}=b_{ik}-\sum\limits^{k-1}_{j=1}l_{ij}u_{jk},&1<k\leq i,&i,k=2,\ldots,R.\\
u_{ik}=(a_{ik}-\sum\limits^{i-1}_{j=1}l_{ij}u_{jk})/l_{ii},&k>i>1,&i,k=2,\ldots,R.\\
\end{array}\right.\\
\end{array}\right.
\end{equation}

Процесс вычисления по этим формулам строится следующим образом: вначале по первой из
формул (\ref{13}) вычисляются неизвестные элементы первого столбца матрицы $L:\mbox{
}l_{i1},\mbox{ },i=1,\ldots,R$, затем по второй из формул (\ref{13}) вычисляются
неизвестные элементы первой строки матрицы $U:\mbox{ }u_{ik},\mbox{ }k=2,\ldots,R$
(напомним, элемент $u_{11}$ известен, он равен 1). Далее в вычислениях участвуют только
третья и четвертая из формул (\ref{13}). По третьей формуле (\ref{13}) вычисляются
неизвестные элементы второго столбца матрицы $L:\mbox{ }l_{i2},\mbox{ },i=2,\ldots,R$
(напомним, $l_{12}=0$, так как $L$-нижняя треугольная) $l_{i2}=b_{i2}-l_{i1}u_{12},\mbox{
} i=2,\ldots,R.$ По четвертой формуле (\ref{13}) вычисляются неизвестные элементы второй
строки матрицы $U:\mbox{ }u_{2k},\mbox{ }k=3,\ldots,R$ (напомним, $u_{21}=0$, т.к.
$U$-верхняя треугольная, $u_{22}=1$, так как $U$ имеет единичную главную диагональ)
$$u_{2k}=(a_{2k}-l_{21}u_{1k})/l_{22},\mbox{ } k=3,\ldots,R.$$
Затем по третьей формуле (\ref{13}) вычисляются неизвестные элементы третьего столбца
матрицы $L:\mbox{ }l_{i3},\mbox{ },i=3,\ldots,R$, а по четвертой формуле (\ref{13})
вычисляются неизвестные элементы третьей строки матрицы $U:\mbox{ }u_{3k},\mbox{
}k=4,\ldots,R$ и так далее. Оценка числа операций для такого алгоритма выполнена в
\cite[\S4]{bogachev}.

{\bf Анализ возможностей DM2-30-17}. Проведем оценку эффективности зеркала на основе написанной программы.
Основную величину, по которой мы будем судить о качестве компенсации искажений, назовем "сглаживанием":
$$\Psi=\frac{S_{before}}{S_{after}}=\sqrt{\frac{\sum\limits_{(r,\theta)}(F-\overline{F})^2}{\sum\limits_{(r,\theta)}((F+D)-\overline{(F+D)})^2}},$$
где $S_{before}$ - среднеквадратичное отклонение формы фронта падающей волны от плоского (на уровне среднего $\overline{F}$) до компенсации, $S_{after}$ - после компенсации, а суммирование ведется по одному набору точек.
Если $\Psi\gg 1$, то использование адаптивного зеркала оправдано. Если $\Psi = 1$, то компенсация несущественна и нет смысла использовать данное адаптивное зеркало, если $\Psi<1$, то следует увеличить число точек, по которым производится аппроксимация и вычисление $\Psi$, а затем повторить расчет.

Оценочный расчет $\Psi$ с помощью программы дает следующие результаты ("чистые" искажения)
\begin{tabular}{|c|c|c|c|c|c|}
  \hline
  % after \\: \hline or \cline{col1-col2} \cline{col3-col4} ...
  искажение & наклон & дефокус & астигматизм & кома & сферич. аберр. \\
  \hline
  $\sim 0.01\lambda$ & 1 & 107 & 102 & 58 & 53 \\
  \hline
  $\sim 0.1\lambda$ & 1 & 107 & 102 & 58 & 53 \\
  \hline
  $\sim 1\lambda$ & 1 & 2.2 & 1.3 & 3.4 & 1.5 \\
  \hline
  $\sim 10\lambda$ & 1 & 1 & 1 & 1 & 1 \\
  \hline

\end{tabular}

Несколько изображений начального фронта и его аппроксимации, полученной с помощью программы, представлены в приложении (аппроксимация по 100 точкам).

Отсюда видно, что зеркало не предназначено для компенсации наклонов (как, собственно, большинство зеркал такого типа - для компенсации наклонов можно использовать более дешевые средства), видно также, что эффективность зеркала падает с увеличением степени полинома и с ростом величины искажений. Причем оптимальный вариант его использования - значения порядка длины волны и меньше.
Что касается выбранного числа точек, по которым производится аппроксимация, то опыт показывает, что увеличение этого числа на порядок со 100 точек до 1000 может увеличивать $\Psi$ в 2 раза, однако увеличивает на порядок время вычислений.

{\bf Вывод.} Получен алгоритм (1)(3) для вычисления управляющих напряжений для данного зеркала, на основе алгоритма написана программа. С помощью программы ислледованы возможности зеркала.

\begin{thebibliography}{9}
\bibitem{uproptsist} М.А.Воронцов, А.В.Корябин, В.И.Шмальгаузен "Управляемые оптические
системы" М.: Наука 1988
\bibitem{BornVolf} М.Борн, Э.Вольф "Основы оптики" М.: Наука 1973
\bibitem{shmalgauzen} М.А.Воронцов, В.И.Шмальгаузен "Принципы адаптивной оптики" М.: Наука
1985
\bibitem{bogachev} К.Ю.Богачев "Практикум на ЭВМ. Методы решения линейных систем и нахождения собственных
значений" М.: Изд-во ЦПИ при механико-математическом ф-те МГУ им. М.В.Ломоносова. 1998
\end{thebibliography}
\end{document}
